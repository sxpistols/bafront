select fullname, sum(t01)t01,sum(t02)t02,sum(t03)t03,sum(t04)t04,sum(t05)t05,
sum(t06)t06,sum(t07)t07,sum(t08)t08,sum(t09)t09,sum(t10)t10,sum(t11)t11,sum(t12)t12,
sum(t13)t13,sum(t14)t14,sum(t15)t15,sum(t16)t16,sum(t17)t17,sum(t18)t18,sum(t19)t19,
sum(t20)t20,sum(t21)t21,sum(t22)t22,sum(t23)t23,sum(t24)t24,sum(t25)t25,sum(t26)t26,
sum(t27)t27,sum(t28)t28,sum(t29)t29,sum(t30)t30,sum(t31)t31 from (
select distinct karyawan.fullname fullname, 
case when timesheet.tanggal_01 is not null then '1' else '' end as 't01', 
case when timesheet.tanggal_02 is not null then '1' else '' end as 't02', 
case when timesheet.tanggal_03 is not null then '1' else '' end as 't03', 
case when timesheet.tanggal_04 is not null then '1' else '' end as 't04', 
case when timesheet.tanggal_05 is not null then '1' else '' end as 't05', 
case when timesheet.tanggal_06 is not null then '1' else '' end as 't06', 
case when timesheet.tanggal_07 is not null then '1' else '' end as 't07', 
case when timesheet.tanggal_08 is not null then '1' else '' end as 't08', 
case when timesheet.tanggal_09 is not null then '1' else '' end as 't09', 
case when timesheet.tanggal_10 is not null then '1' else '' end as 't10', 
case when timesheet.tanggal_11 is not null then '1' else '' end as 't11', 
case when timesheet.tanggal_12 is not null then '1' else '' end as 't12', 
case when timesheet.tanggal_13 is not null then '1' else '' end as 't13', 
case when timesheet.tanggal_14 is not null then '1' else '' end as 't14', 
case when timesheet.tanggal_15 is not null then '1' else '' end as 't15', 
case when timesheet.tanggal_16 is not null then '1' else '' end as 't16', 
case when timesheet.tanggal_17 is not null then '1' else '' end as 't17', 
case when timesheet.tanggal_18 is not null then '1' else '' end as 't18', 
case when timesheet.tanggal_19 is not null then '1' else '' end as 't19', 
case when timesheet.tanggal_20 is not null then '1' else '' end as 't20', 
case when timesheet.tanggal_21 is not null then '1' else '' end as 't21', 
case when timesheet.tanggal_22 is not null then '1' else '' end as 't22', 
case when timesheet.tanggal_23 is not null then '1' else '' end as 't23', 
case when timesheet.tanggal_24 is not null then '1' else '' end as 't24', 
case when timesheet.tanggal_25 is not null then '1' else '' end as 't25', 
case when timesheet.tanggal_26 is not null then '1' else '' end as 't26', 
case when timesheet.tanggal_27 is not null then '1' else '' end as 't27', 
case when timesheet.tanggal_28 is not null then '1' else '' end as 't28', 
case when timesheet.tanggal_29 is not null then '1' else '' end as 't29', 
case when timesheet.tanggal_30 is not null then '1' else '' end as 't30', 
case when timesheet.tanggal_31 is not null then '1' else '' end as 't31' 
from karyawan inner join ( select b.fullname fullname,  bb.name ,
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '01' then '1' end) as tanggal_01, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '02' then '1' end) as tanggal_02, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '03' then '1' end) as tanggal_03, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '04' then '1' end) as tanggal_04, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '05' then '1' end) as tanggal_05, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '06' then '1' end) as tanggal_06, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '07' then '1' end) as tanggal_07, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '08' then '1' end) as tanggal_08, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '09' then '1' end) as tanggal_09, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '10' then '1' end) as tanggal_10, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '11' then '1' end) as tanggal_11, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '12' then '1' end) as tanggal_12, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '13' then '1' end) as tanggal_13, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '14' then '1' end) as tanggal_14, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '15' then '1' end) as tanggal_15, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '16' then '1' end) as tanggal_16, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '17' then '1' end) as tanggal_17, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '18' then '1' end) as tanggal_18, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '19' then '1' end) as tanggal_19, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '20' then '1' end) as tanggal_20, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '21' then '1' end) as tanggal_21, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '22' then '1' end) as tanggal_22, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '23' then '1' end) as tanggal_23, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '24' then '1' end) as tanggal_24, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '25' then '1' end) as tanggal_25, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '26' then '1' end) as tanggal_26, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '27' then '1' end) as tanggal_27, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '28' then '1' end) as tanggal_28, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '29' then '1' end) as tanggal_29, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '30' then '1' end) as tanggal_30, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '31' then '1' end) as tanggal_31 
from boardactions a, trello_karyawan b, board bb 
  where substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),1,7) = '2022-01' 
  and a.username = b.trelloid 
  and a.board_id = bb.id
  group by fullname,board_id
  order by fullname asc) as timesheet 
 on lower(karyawan.fullname) = lower(timesheet.fullname) 
where karyawan.divisi in ('PMO') and karyawan.posisi != 'Support Surveillance' and status = 'Active' order by karyawan.fullname asc)XX
group by fullname;
