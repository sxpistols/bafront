select yy.fullname,yy.name, 
     case when LULULU.t01 is not null then LULULU.t01 else yy.t01 end as 't01',
case when LULULU.t02 is not null then LULULU.t02 else yy.t02 end as 't02',
case when LULULU.t03 is not null then LULULU.t03 else yy.t03 end as 't03',
case when LULULU.t04 is not null then LULULU.t04 else yy.t04 end as 't04',
case when LULULU.t05 is not null then LULULU.t05 else yy.t05 end as 't05',
case when LULULU.t06 is not null then LULULU.t06 else yy.t06 end as 't06',
case when LULULU.t07 is not null then LULULU.t07 else yy.t07 end as 't07',
case when LULULU.t08 is not null then LULULU.t08 else yy.t08 end as 't08',
case when LULULU.t09 is not null then LULULU.t09 else yy.t09 end as 't09',
case when LULULU.t10 is not null then LULULU.t10 else yy.t10 end as 't10',
case when LULULU.t11 is not null then LULULU.t11 else yy.t11 end as 't11',
case when LULULU.t12 is not null then LULULU.t12 else yy.t12 end as 't12',
case when LULULU.t13 is not null then LULULU.t13 else yy.t13 end as 't13',
case when LULULU.t14 is not null then LULULU.t14 else yy.t14 end as 't14',
case when LULULU.t15 is not null then LULULU.t15 else yy.t15 end as 't15',
case when LULULU.t16 is not null then LULULU.t16 else yy.t16 end as 't16',
case when LULULU.t17 is not null then LULULU.t17 else yy.t17 end as 't17',
case when LULULU.t18 is not null then LULULU.t18 else yy.t18 end as 't18',
case when LULULU.t19 is not null then LULULU.t19 else yy.t19 end as 't19',
case when LULULU.t20 is not null then LULULU.t20 else yy.t20 end as 't20',
case when LULULU.t21 is not null then LULULU.t21 else yy.t21 end as 't21',
case when LULULU.t22 is not null then LULULU.t22 else yy.t22 end as 't22',
case when LULULU.t23 is not null then LULULU.t23 else yy.t23 end as 't23',
case when LULULU.t24 is not null then LULULU.t24 else yy.t24 end as 't24',
case when LULULU.t25 is not null then LULULU.t25 else yy.t25 end as 't25',
case when LULULU.t26 is not null then LULULU.t26 else yy.t26 end as 't26',
case when LULULU.t27 is not null then LULULU.t27 else yy.t27 end as 't27',
case when LULULU.t28 is not null then LULULU.t28 else yy.t28 end as 't28',
case when LULULU.t29 is not null then LULULU.t29 else yy.t29 end as 't29',
case when LULULU.t30 is not null then LULULU.t30 else yy.t30 end as 't30',
case when LULULU.t31 is not null then LULULU.t31 else yy.t31 end as 't31'
     FROM(
	select * from (select distinct karyawan.fullname fullname, timesheet.name,timesheet.id,
case when timesheet.tanggal_01 is not null then '1' else '' end as 't01', 
case when timesheet.tanggal_02 is not null then '1' else '' end as 't02', 
case when timesheet.tanggal_03 is not null then '1' else '' end as 't03', 
case when timesheet.tanggal_04 is not null then '1' else '' end as 't04', 
case when timesheet.tanggal_05 is not null then '1' else '' end as 't05', 
case when timesheet.tanggal_06 is not null then '1' else '' end as 't06', 
case when timesheet.tanggal_07 is not null then '1' else '' end as 't07', 
case when timesheet.tanggal_08 is not null then '1' else '' end as 't08', 
case when timesheet.tanggal_09 is not null then '1' else '' end as 't09', 
case when timesheet.tanggal_10 is not null then '1' else '' end as 't10', 
case when timesheet.tanggal_11 is not null then '1' else '' end as 't11', 
case when timesheet.tanggal_12 is not null then '1' else '' end as 't12', 
case when timesheet.tanggal_13 is not null then '1' else '' end as 't13', 
case when timesheet.tanggal_14 is not null then '1' else '' end as 't14', 
case when timesheet.tanggal_15 is not null then '1' else '' end as 't15', 
case when timesheet.tanggal_16 is not null then '1' else '' end as 't16', 
case when timesheet.tanggal_17 is not null then '1' else '' end as 't17', 
case when timesheet.tanggal_18 is not null then '1' else '' end as 't18', 
case when timesheet.tanggal_19 is not null then '1' else '' end as 't19', 
case when timesheet.tanggal_20 is not null then '1' else '' end as 't20', 
case when timesheet.tanggal_21 is not null then '1' else '' end as 't21', 
case when timesheet.tanggal_22 is not null then '1' else '' end as 't22', 
case when timesheet.tanggal_23 is not null then '1' else '' end as 't23', 
case when timesheet.tanggal_24 is not null then '1' else '' end as 't24', 
case when timesheet.tanggal_25 is not null then '1' else '' end as 't25', 
case when timesheet.tanggal_26 is not null then '1' else '' end as 't26', 
case when timesheet.tanggal_27 is not null then '1' else '' end as 't27', 
case when timesheet.tanggal_28 is not null then '1' else '' end as 't28', 
case when timesheet.tanggal_29 is not null then '1' else '' end as 't29', 
case when timesheet.tanggal_30 is not null then '1' else '' end as 't30', 
case when timesheet.tanggal_31 is not null then '1' else '' end as 't31' 
from karyawan inner join ( select b.fullname fullname,  bb.name ,bb.id,
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '01' then '1' end) as tanggal_01, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '02' then '1' end) as tanggal_02, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '03' then '1' end) as tanggal_03, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '04' then '1' end) as tanggal_04, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '05' then '1' end) as tanggal_05, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '06' then '1' end) as tanggal_06, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '07' then '1' end) as tanggal_07, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '08' then '1' end) as tanggal_08, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '09' then '1' end) as tanggal_09, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '10' then '1' end) as tanggal_10, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '11' then '1' end) as tanggal_11, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '12' then '1' end) as tanggal_12, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '13' then '1' end) as tanggal_13, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '14' then '1' end) as tanggal_14, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '15' then '1' end) as tanggal_15, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '16' then '1' end) as tanggal_16, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '17' then '1' end) as tanggal_17, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '18' then '1' end) as tanggal_18, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '19' then '1' end) as tanggal_19, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '20' then '1' end) as tanggal_20, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '21' then '1' end) as tanggal_21, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '22' then '1' end) as tanggal_22, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '23' then '1' end) as tanggal_23, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '24' then '1' end) as tanggal_24, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '25' then '1' end) as tanggal_25, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '26' then '1' end) as tanggal_26, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '27' then '1' end) as tanggal_27, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '28' then '1' end) as tanggal_28, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '29' then '1' end) as tanggal_29, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '30' then '1' end) as tanggal_30, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '31' then '1' end) as tanggal_31 
from boardactions a, trello_karyawan b, board bb 
  where substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),1,7) = '2022-01' 
  and a.username = b.trelloid 
  and a.board_id = bb.id
  group by fullname,board_id
  order by fullname asc) as timesheet 
 on lower(karyawan.fullname) = lower(timesheet.fullname) 
where karyawan.divisi in ('PMO') and karyawan.posisi != 'Support Surveillance' and status = 'Active' order by karyawan.fullname asc) z
where id = '616ec8f865210a33918edffe') yy
LEFT JOIN (select fullname,sum(t01)t01,sum(t02)t02,sum(t03)t03,sum(t04)t04,sum(t05)t05,
sum(t06)t06,sum(t07)t07,sum(t08)t08,sum(t09)t09,sum(t10)t10,sum(t11)t11,sum(t12)t12,
sum(t13)t13,sum(t14)t14,sum(t15)t15,sum(t16)t16,sum(t17)t17,sum(t18)t18,sum(t19)t19,
sum(t20)t20,sum(t21)t21,sum(t22)t22,sum(t23)t23,sum(t24)t24,sum(t25)t25,sum(t26)t26,
sum(t27)t27,sum(t28)t28,sum(t29)t29,sum(t30)t30,sum(t31)t31 from (
select distinct karyawan.fullname fullname, timesheet.name,timesheet.id,
case when timesheet.tanggal_01 is not null then '1' else '' end as 't01', 
case when timesheet.tanggal_02 is not null then '1' else '' end as 't02', 
case when timesheet.tanggal_03 is not null then '1' else '' end as 't03', 
case when timesheet.tanggal_04 is not null then '1' else '' end as 't04', 
case when timesheet.tanggal_05 is not null then '1' else '' end as 't05', 
case when timesheet.tanggal_06 is not null then '1' else '' end as 't06', 
case when timesheet.tanggal_07 is not null then '1' else '' end as 't07', 
case when timesheet.tanggal_08 is not null then '1' else '' end as 't08', 
case when timesheet.tanggal_09 is not null then '1' else '' end as 't09', 
case when timesheet.tanggal_10 is not null then '1' else '' end as 't10', 
case when timesheet.tanggal_11 is not null then '1' else '' end as 't11', 
case when timesheet.tanggal_12 is not null then '1' else '' end as 't12', 
case when timesheet.tanggal_13 is not null then '1' else '' end as 't13', 
case when timesheet.tanggal_14 is not null then '1' else '' end as 't14', 
case when timesheet.tanggal_15 is not null then '1' else '' end as 't15', 
case when timesheet.tanggal_16 is not null then '1' else '' end as 't16', 
case when timesheet.tanggal_17 is not null then '1' else '' end as 't17', 
case when timesheet.tanggal_18 is not null then '1' else '' end as 't18', 
case when timesheet.tanggal_19 is not null then '1' else '' end as 't19', 
case when timesheet.tanggal_20 is not null then '1' else '' end as 't20', 
case when timesheet.tanggal_21 is not null then '1' else '' end as 't21', 
case when timesheet.tanggal_22 is not null then '1' else '' end as 't22', 
case when timesheet.tanggal_23 is not null then '1' else '' end as 't23', 
case when timesheet.tanggal_24 is not null then '1' else '' end as 't24', 
case when timesheet.tanggal_25 is not null then '1' else '' end as 't25', 
case when timesheet.tanggal_26 is not null then '1' else '' end as 't26', 
case when timesheet.tanggal_27 is not null then '1' else '' end as 't27', 
case when timesheet.tanggal_28 is not null then '1' else '' end as 't28', 
case when timesheet.tanggal_29 is not null then '1' else '' end as 't29', 
case when timesheet.tanggal_30 is not null then '1' else '' end as 't30', 
case when timesheet.tanggal_31 is not null then '1' else '' end as 't31' 
from karyawan inner join ( select b.fullname fullname,  bb.name ,bb.id,
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '01' then '1' end) as tanggal_01, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '02' then '1' end) as tanggal_02, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '03' then '1' end) as tanggal_03, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '04' then '1' end) as tanggal_04, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '05' then '1' end) as tanggal_05, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '06' then '1' end) as tanggal_06, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '07' then '1' end) as tanggal_07, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '08' then '1' end) as tanggal_08, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '09' then '1' end) as tanggal_09, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '10' then '1' end) as tanggal_10, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '11' then '1' end) as tanggal_11, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '12' then '1' end) as tanggal_12, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '13' then '1' end) as tanggal_13, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '14' then '1' end) as tanggal_14, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '15' then '1' end) as tanggal_15, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '16' then '1' end) as tanggal_16, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '17' then '1' end) as tanggal_17, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '18' then '1' end) as tanggal_18, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '19' then '1' end) as tanggal_19, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '20' then '1' end) as tanggal_20, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '21' then '1' end) as tanggal_21, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '22' then '1' end) as tanggal_22, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '23' then '1' end) as tanggal_23, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '24' then '1' end) as tanggal_24, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '25' then '1' end) as tanggal_25, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '26' then '1' end) as tanggal_26, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '27' then '1' end) as tanggal_27, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '28' then '1' end) as tanggal_28, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '29' then '1' end) as tanggal_29, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '30' then '1' end) as tanggal_30, 
sum(case when substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),9,2) = '31' then '1' end) as tanggal_31 
from boardactions a, trello_karyawan b, board bb 
  where substring(CONVERT_TZ(tanggal,'+00:00','+07:00'),1,7) = '2022-01' 
  and a.username = b.trelloid 
  and a.board_id = bb.id
  group by fullname,board_id
  order by fullname asc) as timesheet 
 on lower(karyawan.fullname) = lower(timesheet.fullname) 
where karyawan.divisi in ('PMO') and karyawan.posisi != 'Support Surveillance' and status = 'Active' order by karyawan.fullname asc)XX 
group by fullname) LULULU
ON yy.fullname = LULULU.fullname;
